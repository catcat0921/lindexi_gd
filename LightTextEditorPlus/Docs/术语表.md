# 术语

## 行和段

文本里面又多个段落组成，一个段落里面有多个行，一个行里面有多个字符，相邻的使用相同的字符属性的字符组成了 TextRun 文本块

在字符串里面，输入 `\r\n` 换行符时，换的是段落而不是行。行是布局的概念，只有布局完成，才能知道行。段落是文档和布局的概念，在输入完成之后，即可获取到段落

## Char 和 Run

相邻的使用相同的字符属性的 Char 字符组成了 TextRun 文本块

一个 Run 里面可以包含多个 Char 字符

在 Run 里面，除了包含 Char 字符之外，还包含了这些字符的 RunProperty 字符属性

## RunProperty 字符属性

可以表示字符的属性信息，包括字体字号等等

## 文本样式

文本样式是一个比较大的概念，包含了文本的 RunProperty 字符属性和段落属性等。有一些地方使用 样式 来代替 RunProperty 字符属性的概念

文本样式也用来表示被基础继承且不变的属性

## 扩展字符

相对于文本字符来说，允许业务层随意进行扩展的字符，可以是其他元素，例如图片等。只需要实现对应的字符排版功能，即可加入排版

## 换行符

由于多个平台有不同的换行符的定义，为了统一，在文本库里，采用 `\r\n` 作为换行符。排版逻辑里，也依赖此实现。获取字符数量时，段落之间的换行符，采用的是 `\r\n` 两个字符

也就是即使输入的是 `1\n23` 字符串，获取字符数量，将会是 5 个字符

## 不可变对象

由于文本库需要做大量的缓存，为了解决缓存被修改的问题，引入了 Immutable 不可变对象的概念。要求传入文本库的很多对象，只要命名上带了 Immutable 就是要求对象不可变。加入文本之后，不可再更改对象的字段和属性

## 光标偏移量和文档偏移量

光标偏移量指的是光标的偏移，光标是在文本的字符中间。文档偏移量指的是相对于文档开始的字符的偏移量，等于某个字符是文档的第几个字符，从零开始

光标的偏移量示意图如下

```
0 1 2 3 ------ 光标偏移量
| | | |
 A B C  ------ 字符 
```

文档偏移量示意图如下

```
0 1 2 ------ 文档偏移量
| | |              
A B C ------ 字符
```

合在一起的示意图如下

```
0 1 2 3 ------ 光标偏移量
⇃ ⇃ ⇃ ⇃              
⇃0⇃1⇃2⇃ ------ 文档偏移量
⇃|⇃|⇃|⇃              
⇃A⇃B⇃C⇃ ------ 字符
```

可以看到光标偏移和文档偏移量是不相同的

## 英文变量名术语

内容完全参照： [术语表 - FontForge 与字体设计 - UDN开源文档](https://doc.yonyoucloud.com/doc/wiki/project/fontforge-and-font-design/glossary.html )
