# 实现定义

包含具体的实现的细节的定义

## 换行字符

换行使用 `\r\n` 字符

## 空文本

### 空文本段落数量

对外，一个空文本至少存在一段一行

内部，在没有获取时，是不会创建一段一行的，只有在获取段落之后，才会创建首个空段。在布局之后才创建首个空行

这只是为了做性能优化，才不会默认创建一段一行。对外可以获取到一段一行可以减少上层业务的判断逻辑

## 渲染

### 渲染行缓存

渲染的时候，如果一行没有被更改，意味着这一行的渲染内容可以复用。在文本库里，通过 ParagraphLineRenderInfo 参数设置行渲染信息，也就是以下方法

```csharp
ParagraphLineRenderInfo.SetDrawnResult(in LineDrawnResult lineDrawnResult)
```

设置进入的 LineDrawnResult 是一个 object 类型。将会在下次渲染时，带入到 LineDrawingArgument 参数里面

加上行渲染缓存，可以比较大提升重复渲染的性能

## 遇到的问题

对于文本字符来说，文本字符属性是采用不可变对象，尽量使用相同的对象。但是这样就存在一个问题，那就是超链接。超链接点击的时候需要修改超链接的颜色。如果超链接的文本字符属性被分割开，那是否影响被分割的内容？其实不然。这里就存在破坏设计

输入的文本需要判断是否可以使用前后继承的文本字符属性，从而减少文本字符属性的数量

